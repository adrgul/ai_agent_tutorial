# ==================================================
## ========== RAG √©s LLM kommunik√°ci√≥ ==============
# ==================================================
## Egyel≈ëre csak az IT √©s marketing domainek "√©lnek" a t√∂bbi domainre mock v√°laasz j√∂n

# ----------- Request JSON (p√©lda - marketing domain) -------------------
{
  "user_id": "demo_user",
  "session_id": "demo_session",
  "query": "milyen sz√≠nek megengedettek?"
}

# ----------- Response JSON (p√©lda - marketing domain) ------------------
{
  "domain": "marketing",
  "answer_length": 666,
  "citation_count": 2,  # ‚úÖ v2.4: Deduplik√°lva 5 ‚Üí 2
  "workflow_triggered": false
}

# ---------- RAG context (p√©lda - marketing domain) ---------------------
# ‚ö†Ô∏è V2.4 EL≈êTT: 5 duplic√°lt dokumentum (PDF + DOCX verzi√≥)
# ‚úÖ V2.4 UT√ÅN: Deduplik√°lt, csak 1-2 unique dokumentum

[Doc 1: Aurora_Digital_Arculati_Kezikonyv_HU.pdf] (score: 0.95 + feedback boost)
Egy√©rtelm≈± √°ll√≠t√°sok el≈ënyben r√©szes√≠t√©se.  
4. Log√≥haszn√°lat  
A log√≥ ar√°nyai nem torz√≠that√≥k.  
Minim√°lis v√©d≈ët√°vols√°g: a log√≥ 'A' bet≈±j√©nek magass√°ga.  
Tilos a log√≥ √°tsz√≠nez√©se, forgat√°sa vagy effektez√©se.  
Prefer√°lt elhelyez√©s: bal fels≈ë sarok vagy k√∂z√©pre igaz√≠tva.  
5. Sz√≠npaletta  
Els≈ëdleges sz√≠n: √âjk√©k (#0B1C2D)  
M√°sodlagos sz√≠n: Aurora t√ºrkiz (#1FA6A3)
Kieg√©sz√≠t≈ë sz√≠n: Vil√°gossz√ºrke (#E6E8EB)  
Hiba / figyelmeztet√©s: Jelz≈ëpiros (#C0392B)  
A sz√≠nek k√∂vetkezetes, visszafogott haszn√°lata k√∂telez≈ë...

[Doc 2: Aurora_Digital_Arculati_Kezikonyv_HU.pdf] (score: 0.88)
--- Page 2 ---
6. Tipogr√°fia  
Els≈ëdleges bet≈±t√≠pus: Inter (Regular, Medium, SemiBold)  
Alternat√≠v bet≈±t√≠pusok: Arial, Helvetica, sans-serif  
C√≠msorok: SemiBold  
T√∂rzssz√∂veg: Regular  
Dekorat√≠v bet≈±t√≠pusok haszn√°lata nem megengedett.  
7. Elrendez√©s √©s t√©rk√∂z  
Megfelel≈ë mennyis√©g≈± √ºres t√©r alkalmaz√°sa.  
R√°csszerkezethez igaz√≠tott elrendez√©s.  
F√ºgg≈ëleges ritmus el≈ënyben r√©szes√≠t√©se.  
Maxim√°lis sorhossz: 70‚Äì80 karakter...

# ------------ LLM Prompt (p√©lda - marketing domain) --------------------
You are a helpful HR/IT/Finance/Legal/Marketing assistant.

Retrieved documents (use ALL relevant information):
[Document 1: Aurora_Digital_Arculati_Kezikonyv_HU.pdf]
Egy√©rtelm≈± √°ll√≠t√°sok el≈ënyben r√©szes√≠t√©se.  
4. Log√≥haszn√°lat  
A log√≥ ar√°nyai nem torz√≠that√≥k.  
Minim√°lis v√©d≈ët√°vols√°g: a log√≥ 'A' bet≈±j√©nek magass√°ga.  
Tilos a log√≥ √°tsz√≠nez√©se, forgat√°sa vagy effektez√©se.  
Prefer√°lt elhelyez√©s: bal fels≈ë sarok vagy k√∂z√©pre igaz√≠tva.  
5. Sz√≠npaletta  
Els≈ëdleges sz√≠n: √âjk√©k (#0B1C2D)  
M√°sodlagos sz√≠n: Aurora t√ºrkiz (#1FA6A3)

[Document 2: Aurora_Digital_Arculati_Kezikonyv_HU.docx]
Egy√©rtelm≈± √°ll√≠t√°sok el≈ënyben r√©szes√≠t√©se.

4. Log√≥haszn√°lat

A log√≥ ar√°nyai nem torz√≠that√≥k.

Minim√°lis v√©d≈ët√°vols√°g: a log√≥ 'A' bet≈±j√©nek magass√°ga.

Tilos a log√≥ √°tsz√≠nez√©se, forgat√°sa vagy effektez√©se.

Prefer√°lt elhelyez√©s: bal fels≈ë sarok vagy k√∂z√©pre igaz√≠tva.

5. Sz√≠npaletta

Els≈ëdleges sz√≠n: √âjk√©k (#0B1C2D)

M√°sodlagos sz√≠n: Aurora t√ºrkiz (#1FA6A3)

Kieg√©sz√≠t≈ë sz√≠n: Vil√°gossz√ºrke (#E6E8EB)

Hiba / figyelmeztet√©s: Jelz≈ëpiros (#C0392B)

A sz√≠nek k√∂vetkezetes, visszafogott haszn√°lata k√∂telez≈ë.

6. Tipogr√°fia

Els≈ëdleges bet≈±t√≠pus: Inter (Regular, Medium, SemiBold)

Alternat√≠v bet≈±t√≠pusok: Arial, Helvetica, sans-serif

C√≠msorok: SemiBold

T√∂rzssz√∂veg: Regular

Dekorat√≠v bet≈±t√≠pusok haszn√°lata nem megengedett.

7. Elrendez√©s √©s t√©rk√∂z

Megfelel≈ë mennyis√©g≈± √ºres t√©r alkalmaz√°sa.

[Document 3: Aurora_Digital_Arculati_Kezikonyv_HU.pdf]
--- Page 2 ---
Kieg√©sz√≠t≈ë sz√≠n: Vil√°gossz√ºrke (#E6E8EB)  
Hiba / figyelmeztet√©s: Jelz≈ëpiros (#C0392B)  
A sz√≠nek k√∂vetkezetes, visszafogott haszn√°lata k√∂telez≈ë.  
6. Tipogr√°fia  
Els≈ëdleges bet≈±t√≠pus: Inter (Regular, Medium, SemiBold)  
Alternat√≠v bet≈±t√≠pusok: Arial, Helvetica, sans -serif  
C√≠msorok: SemiBold  
T√∂rzssz√∂veg: Regular  
Dekorat√≠v bet≈±t√≠pusok haszn√°lata nem megengedett.  
7. Elrendez√©s √©s t√©rk√∂z  
Megfelel≈ë mennyis√©g≈± √ºres t√©r alkalmaz√°sa.  
R√°csszerkezethez igaz√≠tott elrendez√©s.  
F√ºgg≈ëleges ritmus el≈ënyben r√©szes√≠t√©se.  
Maxim√°lis sorhossz: 70 ‚Äì80 karakter.  
8. Ikonhaszn√°lat √©s vizu√°lis st√≠lus  
Egyszer≈±, vonalas ikonok haszn√°lata.  
Egys√©ges vonalvastags√°g.  
T√∫lzottan r√©szletes grafik√°k ker√ºl√©se.  
A vizu√°lis elemek t√°mogass√°k a tartalmat.

[Document 4: Aurora_Digital_Arculati_Kezikonyv_HU.docx]
7. Elrendez√©s √©s t√©rk√∂z

Megfelel≈ë mennyis√©g≈± √ºres t√©r alkalmaz√°sa.

R√°csszerkezethez igaz√≠tott elrendez√©s.

F√ºgg≈ëleges ritmus el≈ënyben r√©szes√≠t√©se.

Maxim√°lis sorhossz: 70‚Äì80 karakter.

8. Ikonhaszn√°lat √©s vizu√°lis st√≠lus

Egyszer≈±, vonalas ikonok haszn√°lata.

Egys√©ges vonalvastags√°g.

T√∫lzottan r√©...

[Document 5: Aurora_Digital_Arculati_Kezikonyv_HU.pdf]
T√∫lzottan r√©szletes grafik√°k ker√ºl√©se.  
A vizu√°lis elemek t√°mogass√°k a tartalmat.  
9. Helyes √©s helytelen haszn√°lat  
HELYES: Egys√©ges sz√≠nhaszn√°lat.  
HELYES: Letisztult megfogalmaz√°s.  
HELYTELEN: Akcentussz√≠nek t√∫lhaszn√°lata.  
HELYTELEN: Inform√°lis vagy szleng kifejez√©sek.  
10. Tulajdonjog √©s...

User query: "milyen sz√≠nek megengedettek?"

Provide a comprehensive answer based on the retrieved documents above.
Combine information from multiple sources when they relate to the same topic.
If asking about guidelines or rules, include ALL relevant details found in the documents.
Use proper formatting with line breaks and bullet points for better readability.
Answer in Hungarian if the query is in Hungarian, otherwise in English.

# ------------ LLM Response (p√©lda - marketing domain) --------------------
A megengedett sz√≠nek az "Aurora Digital" arculati k√©zik√∂nyv alapj√°n a k√∂vetkez≈ëk:

### Sz√≠npaletta
- **Els≈ëdleges sz√≠n**: 
  - √âjk√©k (#0B1C2D)
  
- **M√°sodlagos sz√≠n**: 
  - Aurora t√ºrkiz (#1FA6A3)

- **Kieg√©sz√≠t≈ë sz√≠n**: 
  - Vil√°gossz√ºrke (#E6E8EB)

- **Hiba / figyelmeztet√©s sz√≠n**: 
  - Jelz≈ëpiros (#C0392B)

### Haszn√°lati ir√°nyelvek
- A sz√≠nek k√∂vetkezetes √©s visszafogott haszn√°lata k√∂telez≈ë.
- Az akcentussz√≠nek t√∫lhaszn√°lata **HELYTELEN**.
- A vizu√°lis elemeknek t√°mogathatj√°k a tartalmat, ker√ºlj√ºk a t√∫lzottan r√©szletes grafik√°kat.

Ez√©rt a megadott sz√≠nek haszn√°lata mellett fontos a sz√≠nkombin√°ci√≥k k√∂vetkezetess√©ge √©s a t√∫lzott sz√≠nhaszn√°lat elker√ºl√©se.

# ===========================================================================
# ========== LLM √©s RAG pontoss√°got √©s hat√©konys√°got jav√≠t√≥ int√©zked√©sek
# ===========================================================================

LLM/RAG Funkcionalit√°sok - Pontoss√°g & Hat√©konys√°g
üéØ Pontoss√°g jav√≠t√°sa
Section ID hivatkoz√°sok (IT domain)

Confluence IT Policy szakaszokat [IT-KB-234] form√°tumban indexelunk
LLM prompt-ba be√©p√≠tett utas√≠t√°s: csak val√≥s section ID-kat haszn√°ljon
Fallback: ha LLM elfelejti, szerz≈ës√©gi l√°nc automatikusan hozz√°adja
Domain-specifikus instrukci√≥ik

IT: l√©p√©senk√©nti hibaelh√°r√≠t√°s + section ID hivatkoz√°sok + Jira ticket aj√°nl√°s
Marketing: arculati k√©zik√∂nyv szab√°lyok betart√°sa, vizu√°lis konzisztencia
HR/Finance/Legal: saj√°t szakter√ºlet-specifikus promptok
Feedback-s√∫lyozott rangsorol√°s

User Like/Dislike visszajelz√©sek ‚Üí Citation score boost/penalty
Magasabb quality tartalom el≈ëbbre ker√ºl a k√∂vetkez≈ë lek√©rdez√©sn√©l
Dinamikus tanul√°s: rossz v√°laszok dem√≥t√°l√≥dnak (-20%), j√≥ v√°laszok feler≈ës√∂dnek (+30%)
Tartalom-alap√∫ deduplik√°ci√≥

PDF/DOCX ugyanazon dokumentum t√∂bbsz√∂r√∂s indexel√©s√©b≈ël v√°lt
Tiszt√°bb LLM context (kevesebb ism√©tl√©s = jobb min≈ës√©g)
‚ö° Hat√©konys√°g jav√≠t√°sa
3-r√©teg≈± Redis cache

L1: Query result cache (teljes v√°lasz) - leggyorsabb
L2: Embedding cache - embedding gener√°l√°s kiv√°lt√°sa
L3: Direct document fetch by ID - Qdrant keres√©s kiv√°lt√°sa
Lexikai overlap reranking (IT)

Query tokent√∂lt√∂bb (3+ karakter) alapj√°n boost relevancia
0-20% score boost a tartalmi egyez√©s alapj√°n
Nem hardcoded: minden IT t√©m√°hoz m≈±k√∂dik generikusan
Batch feedback fetch

√ñsszes citation feedback egy SQL lek√©rdez√©sben
Connection pool v√©delme, N+1 query elker√ºl√©se
Token limit v√©delem

Prompt m√©ret check el≈ëtte: gpt-4o-mini 128k context
Ha t√∫lm√©retes: top 3 doc-ra sz≈±k√≠t√©s + retry
Timeout elker√ºl√©s
Domain filter Qdrant-ban

Csak relev√°ns domain dokumentumai keres√©se
Felesleges atravesz√°l√°s kik√ºsz√∂b√∂l√©se
Structured RAG context telemetria

RAG context, LLM prompt, LLM response logol√°sa
Debug panel: transzparens insight a d√∂nt√©sekbe
Citation tracking: mely dokik befoly√°solt√°k a v√°laszt